{%extends 'college_template.html'%}


{%block header%}
	{%load static%}
	<link rel="stylesheet" type="text/css" href="{% static "attendence/home.css"%}"></link>
	<script type='text/javascript' src="{%static 'attendence/Chart.min.js'%}"></script>
	<script type='text/javascript' src="{%static 'attendence/home.js'%}"></script>
	
{%endblock%}


{%block body%}

<input type='hidden' value='{{url}}' id='attendence_url'></input>
<div>
	<select id='course'>
		{%for course in courses%}
			<option value={{course.id}}>{{course.name}}</option>
		{%endfor%}
		
	</select>
	<select id='semester'>
		<option value=1>1</option>
		<option value=2>2</option>
		<option value=3>3</option>
		<option value=1>4</option>
		<option value=1>5</option>
		<option value=1>6</option>
		
	</select>
	<button id='get_attendence'>Get Attendence</button>
	{{error}}
</div>


{%if class_attend%}
	<hr>
	<div id='tabs'>
		
		{%regroup class_attend by student as student_list%}
		<div id='namecloud'>
			{%for student in student_list%}
				<a href='#'id='{{forloop.counter}}'>{{student.grouper}}</a>
			{%endfor%}
		</div>
		<script>var datalist=[];</script>
		{%for student in student_list%}
			<div id='{{forloop.counter}}'>
				<div style="width: 50%;float:right;">
							<canvas id="canvas" height="450" width="600"></canvas>
				</div>
				<script>
				var data={labels:[],datasets:[]};
				var lecture={
								fillColor : "rgba(220,220,220,0.5)",
								strokeColor : "rgba(220,220,220,0.8)",
								highlightFill: "rgba(220,220,220,0.75)",
								highlightStroke: "rgba(220,220,220,1)",
								data : []
							};
					data.datasets.push(lecture);
					var tutorial={
								fillColor : "rgba(151,187,205,0.5)",
								strokeColor : "rgba(151,187,205,0.8)",
								highlightFill : "rgba(151,187,205,0.75)",
								highlightStroke : "rgba(151,187,205,1)",
								data : []
							};
					data.datasets.push(tutorial);
					var practical={
								fillColor : "rgba(151,187,100,0.5)",
								strokeColor : "rgba(151,187,205,0.8)",
								highlightFill : "rgba(151,187,205,0.75)",
								highlightStroke : "rgba(151,187,205,1)",
								data : []
							}
					data.datasets.push(practical);
					lecture=data.datasets[0].data;
					tutorial=data.datasets[1].data;
					practical=data.datasets[2].data;
				{%for rec in student.list%}
					data.labels.push('{{rec.paper_attend.paper.code}}');
					
					
					
					lecture.push({%widthratio rec.month1.lecture rec.paper_attend.month_total_1.lecture 100%});
					tutorial.push({%widthratio rec.month1.tutorial rec.paper_attend.month_total_1.tutorial 100%});
					practical.push({%widthratio rec.month1.practical rec.paper_attend.month_total_1.practical 100%});
				datalist.push(data);
				{%endfor%}
				var ctx = $("#canvas").get(0).getContext("2d");
				new Chart(ctx).Bar(data, {
				responsive : true, scaleFontColor: "black",
				});
				</script>
			</div>
		{%endfor%}
				
	</div>
{%endif%}
{%endblock%}
